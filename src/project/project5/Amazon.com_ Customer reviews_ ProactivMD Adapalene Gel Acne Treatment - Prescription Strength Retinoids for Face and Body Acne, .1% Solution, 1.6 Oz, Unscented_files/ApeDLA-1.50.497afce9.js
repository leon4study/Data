(()=>{const e=e=>e+"_Feedback";class t{async addSponsoredLabelWithFeedbackLink(e,t){e.appendChildTo(this.parentHtmlId,this);const n=await t.getSponsoredLabelAndFeedbackLink(this.urlPathAndParameter);if(!(null==n?void 0:n.isOk()))throw new Error(`Result from the feedback service was not ok ${this.urlPathAndParameter}`);e.updateElement(this.getHtmlId(),n)}getHtmlId(){return e(this.parentHtmlId)}isHidden(){return this.hidden}exists(e){return e.exists(this.getHtmlId())}constructor(e,t,n,i,a,r,s){this.parentHtmlId=e,this.feedbackStyle=t,this.labelText=n,this.labelStyle=i,this.position=a,this.urlPathAndParameter=r,this.hidden=s}}class n{open(e){e.clickChildLink(this)}getHtmlId(){return e(this.parentHtmlId)}constructor(e){this.parentHtmlId=e}}var i=function(e){console.debug(e)},a=function(e,t){console.error(e,JSON.stringify(t)),r("ERROR",e,s(e,t))},r=function(e,t,n){var i;null===(i=window.ueLogError)||void 0===i||i.call(window,n,{logLevel:e,attribution:"APE-safeframe",message:t+" | "})},s=function(e,t){return t instanceof Error?t:t?new Error(t):new Error(e)};class o{async createSponsoredLabelWithFeedbackLink(e,t){if(!e.exists(this.feedbackHtmlPort)){t.request();try{await e.addSponsoredLabelWithFeedbackLink(this.feedbackHtmlPort,this.feedbackApiPort),t.success(),e.isHidden()||t.labelRenderedHost()}catch(n){throw t.error(),n}}}openModal(e){e.open(this.feedbackHtmlPort)}labelRendered(e){e.labelRenderedCreative()}removeSponsoredLabelAndFeedbackLink(t){try{var n;null===(n=document.getElementById(e(t)))||void 0===n||n.remove()}catch(i){a("Unable to remove AdFeedback Div",i)}}logTransparencyInfoMissing(e){e.transparencyInfoMissing()}constructor(e,t){this.feedbackHtmlPort=e,this.feedbackApiPort=t}}var d=/(\/b|\/s|\/l).*(node=)(\d{1,12})/,l=new Map,c=function(){if(!l.has(window.location.href)){var e=d.exec(window.location.href),t=e&&e[3]?e[3]:null;l.set(window.location.href,t)}return l.get(window.location.href)},u=function(e){var t=c();if(!e||!t)return null;var n=e.split(":");return n.splice(n.length-1,0,t),n.join(":")},m=function(e){var t=c();return t?"".concat(e,":").concat(t):null},p=function(e){return e.replace(/_/g,":")},h=function(e,t,n){var i,a,r,s,o,d;if(void 0===n&&(n=1),!w())return window.safeframe=null!==(i=window.safeframe)&&void 0!==i?i:{},window.safeframe.csmCache=null!==(a=window.safeframe.csmCache)&&void 0!==a?a:{},window.safeframe.csmCache.incrementCsmPlacementCounter=null!==(r=window.safeframe.csmCache.incrementCsmPlacementCounter)&&void 0!==r?r:[],void window.safeframe.csmCache.incrementCsmPlacementCounter.push({metric:e,placement:t,count:n});null===(d=null===(o=null===(s=window.safeframe)||void 0===s?void 0:s.csmCache)||void 0===o?void 0:o.incrementCsmPlacementCounter)||void 0===d||d.forEach((function(e){return h(e.metric,e.placement,e.count)}));var l=function(e,t,n){t&&f("".concat(g(e),":").concat(t),n)};l(e,t.id,n),l(e,m(t.id),n),l(e,p(t.name),n),l(e,u(p(t.name)),n)},v=function(e,t){var n,i,a,r,s,o;if(void 0===t&&(t=1),!w())return window.safeframe=null!==(n=window.safeframe)&&void 0!==n?n:{},window.safeframe.csmCache=null!==(i=window.safeframe.csmCache)&&void 0!==i?i:{},window.safeframe.csmCache.incrementCsmCounter=null!==(a=window.safeframe.csmCache.incrementCsmCounter)&&void 0!==a?a:[],void window.safeframe.csmCache.incrementCsmCounter.push({metric:e,count:t});null===(o=null===(s=null===(r=window.safeframe)||void 0===r?void 0:r.csmCache)||void 0===s?void 0:s.incrementCsmCounter)||void 0===o||o.forEach((function(e){return v(e.metric,e.count)})),f(g(e),t)},w=function(){var e;return"function"==typeof(null===(e=null===window||void 0===window?void 0:window.ue)||void 0===e?void 0:e.count)},f=function(e,t){var n;return null===(n=null===window||void 0===window?void 0:window.ue)||void 0===n?void 0:n.count(e,t)},b="adplacements",g=function(e){return e.startsWith(b)?e:"".concat(b,":").concat(e)},y=function(e){if(window.csa)try{window.csa("Events",{producerId:"adplacements"})("setEntity",{adCreativeMetaData:e})}catch(t){a("Error with 'setEntity' CSA",t)}},P=function(e,t,n){if(void 0===n&&(n=1),window.csa)try{window.csa("Events",{producerId:"adplacements"})("log",{schemaId:"ApeSafeframe.csaEvent.1",metricName:e+":"+t.name+":"+t.id,metricValue:n},{ent:"all"})}catch(i){a("Error with 'logCsaEvent' CSA",i)}},E=function(e,t){if(void 0===t&&(t=1),window.csa)try{window.csa("Events",{producerId:"adplacements"})("log",{schemaId:"ApeSafeframe.csaEvent.1",metricName:e,metricValue:t},{ent:"all"})}catch(n){a("Error with 'incrementCounter' CSA",n)}};const k=e=>new R(e),A="adfeedback_request",x="adfeedback_success",T="adfeedback_error",I="adfeedback_sponsoredlabelrendered_creative",S="adfeedback_sponsoredlabelrendered_host",L="adfeedback:request",C="adfeedback:success",D="adfeedback:error",_="adfeedback:sponsoredlabelrendered:creative",N="adfeedback:sponsoredlabelrendered:host",M="adfeedback:sponsoredlabelrendered",F="adfeedback:transparencyinfo:missing";class R{request(){h(L,this.placement),v(L),P(A,this.placement)}success(){h(C,this.placement),v(C),P(x,this.placement)}error(){h(D,this.placement),P(T,this.placement)}labelRenderedCreative(){h(_,this.placement),v(M),P(I,this.placement)}labelRenderedHost(){h(N,this.placement),v(M),P(S,this.placement)}transparencyInfoMissing(){h(F,this.placement),v(F)}constructor(e){this.placement=e}}class B{isOk(){return"ok"===this.status}constructor(e,t,n){this.status=e,this.html=t,this.script=n}}class O{async getSponsoredLabelAndFeedbackLink(e){const t=await fetch(this.windowRepo.origin()+e);if(t.ok){const e=await t.json();return new B(e.status,e.html,e.script)}throw Error("Could not fetch the feedback html/link/script/label")}constructor(e){this.windowRepo=e}}class z{appendChildTo(e,t){var n,i;function a(e,t){const n=document.createElement("div");return n.setAttribute("id",t.getHtmlId()),n.classList.add("ape-feedback"),n.style.position="relative",n.style.height="20px",n.style.textAlign=n.id.includes("hero-quick-promo_Desktop_placement_Feedback")?"left":"right",n.style.padding="0",n.style.marginTop="2px",n.style.display=t.feedbackStyle.display,e.endsWith("_wrapper")&&(!e.includes("-ilm")&&(n.style.maxWidth="min(100vh, 100vw)"),n.style.marginLeft="auto",n.style.marginRight="auto",n.style.padding="0 5px"),n.append(function(e){const t=document.createElement("div");return t.innerHTML=e.labelText,U(t,e.labelStyle),t}(t)),n}1===t.position?null===(n=document.getElementById(e))||void 0===n||n.prepend(a(e,t)):0===t.position&&(null===(i=document.getElementById(e))||void 0===i||i.append(a(e,t)))}updateElement(e,t){const n=document.getElementById(e);if(n){n.innerHTML=t.html,H(n,t);for(const e of n.children)"DIV"===e.tagName?e.removeAttribute("style"):"A"===e.tagName&&(e.style.removeProperty("position"),e.style.removeProperty("top"),e.style.removeProperty("right"),e.style.removeProperty("display"))}}clickChildLink(e){const t=document.getElementById(e.getHtmlId());for(const i of(null==t?void 0:t.children)||[])if("A"===(n=i).tagName||"DIV"===n.tagName)return void i.click();var n}exists(e){return!!document.getElementById(e)}}const U=(e,t)=>{for(const n in t)e.style.setProperty(n,t[n])},H=(e,t)=>{V(e).innerHTML=t.script},V=e=>{const t=document.createElement("script");return e.prepend(t),t},W={code:"BE",hostname:"www.amazon.com.be",name:"Belgium"},$={code:"FR",hostname:"www.amazon.fr",name:"France"},G={code:"DE",hostname:"www.amazon.de",name:"Germany"},q={code:"IT",hostname:"www.amazon.it",name:"Italy"},J={code:"NL",hostname:"www.amazon.nl",name:"Netherlands"},j={code:"PL",hostname:"www.amazon.pl",name:"Poland"},K={code:"ES",hostname:"www.amazon.es",name:"Spain"},Q={code:"SE",hostname:"www.amazon.se",name:"Sweden"},Z=e=>location.hostname===e.hostname;class Y{constructor(e,t){this.weblabsWindow=e,this.prefix=t,this.isT1=()=>"t1"===this.weblabTreatment(),this.isT2=()=>"t2"===this.weblabTreatment(),this.isT3=()=>"t3"===this.weblabTreatment(),this.isT4=()=>"t4"===this.weblabTreatment(),this.isT5=()=>"t5"===this.weblabTreatment(),this.weblabTreatment=()=>{var e,t,n;return null===(n=this.weblabsWindow)||void 0===n||null===(t=n.renderingWeblabs)||void 0===t||null===(e=t[this.prefix])||void 0===e?void 0:e.toLowerCase()}}}const X=()=>new Y(window,"ADPT_SF_TRANSPARENCY_INFO_MANDATORY_FOR_EU_712921"),ee=()=>new Y(window,"ADPT_SF_BTR_PIXEL_LIGHTADS_1064211"),te=e=>!(Z(W)||Z($)||Z(G)||Z(q)||Z(J)||Z(j)||Z(K)||Z(Q))||ne(e),ne=e=>{var t,n,i,r,s,o;const d=[];ae(null==e||null===(i=e.url)||void 0===i||null===(n=i.parameters)||void 0===n||null===(t=n.adPlacementMetaData)||void 0===t?void 0:t.slotName)&&d.push("DSA Error: slotName missing");const l=null==e||null===(o=e.url)||void 0===o||null===(s=o.parameters)||void 0===s||null===(r=s.adCreativeMetaData)||void 0===r?void 0:r.adCreativeDetails;(!l||l.length<=0)&&d.push("DSA Error: transparency info missing"),null==l||l.every((e=>ie(e,d)));for(const c of d)for(let e=0;e<re();e++)a(c);return d.length<=0},ie=(e,t)=>{var n,i,a,r,s;e.version||t.push("DSA Error: version missing"),ae(e.advertiserIdNS)&&t.push("DSA Error: advertiserIdNS missing"),void 0!==(null===(n=e.selectionSignals)||void 0===n?void 0:n.context)&&null!==(null===(i=e.selectionSignals)||void 0===i?void 0:i.context)||t.push("DSA Error: selectionSignals.context missing"),void 0!==(null===(a=e.selectionSignals)||void 0===a?void 0:a.location)&&null!==(null===(r=e.selectionSignals)||void 0===r?void 0:r.location)||t.push("DSA Error: selectionSignals.location missing"),ae(null===(s=e.selectionSignals)||void 0===s?void 0:s.pastActivity)&&t.push("DSA Error: selectionSignals.pastActivity missing")},ae=e=>!e||e.length<=0,re=()=>X().isT1()?2:X().isT2()?4:X().isT3()?8:X().isT4()?16:X().isT5()?32:1,se=e=>ce(e),oe=/^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)?$/,de=e=>oe.test(e),le=e=>btoa(unescape(encodeURIComponent(e))),ce=e=>decodeURIComponent(escape(atob(e))),ue=e=>e?e.split("&c=${AAX_PAYLOAD}").join(""):e,me=()=>new pe(new o(new z,new O({origin:()=>window.location.origin})));class pe{async addSponsoredLabel({parentHtmlId:e,placement:t,feedback:n}){return te(n)?(n.hidden&&(Object.assign(n.style,{display:"none"}),Object.assign(n.label.style,{display:"none"})),await this.feedbackService.createSponsoredLabelWithFeedbackLink(he(e,n),k(t)),!0):(this.feedbackService.logTransparencyInfoMissing(k(t)),a("Transparency Information missing"),!1)}openModal(e){this.feedbackService.openModal(new n(e))}labelRendered({placement:e}){this.feedbackService.labelRendered(k(e))}removeSponsoredLabelAndFeedbackLink(e){this.feedbackService.removeSponsoredLabelAndFeedbackLink(e)}constructor(e){this.feedbackService=e}}const he=(e,n)=>{const i=JSON.parse(JSON.stringify(n.url.parameters));var a,r,s;return i.adPlacementMetaData.pageUrl=(a=i.adPlacementMetaData.pageUrl,de(a)?a:le(a)),new t(e,n.style,n.label.text,n.label.style,"TOP"===n.position?1:0,(r=n.url.path,s=encodeURIComponent(JSON.stringify(i)),r+"?pl="+s),n.hidden)};class ve{constructor(e){this.lightAdWindow=e,this.getByPlacementDiv=e=>{var t;return null!==(t=this.lightAdWindow.lightAds[e.id])&&void 0!==t?t:null},this.getByPlacement=e=>this.getByPlacementDiv(e.div),this.save=e=>{this.lightAdWindow.lightAds[e.placement.div.id]=e},we(e)}}const we=e=>{e.lightAds||(e.lightAds={})},fe=()=>new ve(window);class be{labelRendered(e){try{const t=ge(e);me().labelRendered({placement:{id:t.placementId,name:t.placementName}})}catch(t){a(`Light ad - labelRendered failed for '${e}'`)}}openModal(e){try{const t=ye(e).parentElement;me().openModal(t.id)}catch(t){a(`Light ad - openModal failed for '${e}'`)}}}const ge=e=>{const t=ye(e);return fe().getByPlacementDiv(t).lightAdDetails},ye=e=>{const t=document.getElementById(e);if(!t)throw new Error(`Placement div '${e}' doesn't exist`);return t},Pe=e=>null==e?void 0:e.replace("criticalFeature","").replace("windowOnLoad","").replace("spATFEvent","").replace("r2OnLoad","").replace("aboveTheFold","").replace("af",""),Ee="btr_client",ke="cod_client";var Ae=function(e,t,n){if(""===t)throw new Error("Invalid queryParamKey input to addJSONQueryParamToURL: "+JSON.stringify({queryParamKey:t}));var i=new URL(e),a=i.searchParams.get(t),r=a||"{}",s=JSON.parse(r),o=Object.assign(s,n);return i.searchParams.set(t,JSON.stringify(o)),i.toString()};var xe=function(){return xe=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},xe.apply(this,arguments)},Te=function(e){return e.complete&&e.naturalHeight>1&&e.naturalWidth>1},Ie=function(e){return e.naturalHeight<=1&&e.naturalWidth<=1},Se=function(e){var t=e.getElementsByClassName("mrc-btr-creative"),n=t.length>0,i=n?t:e.getElementsByTagName("img");return xe({isBTRTaggedCreative:n},function(e){for(var t=[],n=0,i=0,a=0;a<e.length;a++){var r=e[a];r instanceof HTMLImageElement&&(Te(r)?(t.push({src:r.src,isLoaded:!0}),n++):Ie(r)||(t.push({src:r.src,isLoaded:!1}),i++))}return{isBTRCompliant:n>0&&0===i,imagesData:t}}(i))},Le=function(e,t){return Se(t)};const Ce=({abpAcceptable:e="false",abpStatus:t="-1"})=>"true"===e&&("1"===t||"-1"===t),De="aUAZqFtiIp6VxqpW3coqZ2JdZnV3RN9S8yKMRIdJ",_e=e=>{new Y(window,"ADPT_SF_METRICS_LOGGING_1100263").isT1()&&navigator.sendBeacon&&navigator.sendBeacon(`https://e5qq6zj76g.execute-api.us-east-1.amazonaws.com/metric?x-api-key=${De}`,JSON.stringify(e))},Ne=(e,t,n)=>({metricName:e,count:t,dimensions:n,xApiKey:De}),Me=e=>{var t,n;return{app:"LA",siteName:e.siteName,slotName:e.slotName,pageType:e.pageType,subPageType:e.subPageType,placementId:e.placementId,mediaType:e.creative.mediaType,programId:null===(t=e.adCreativeMetaData)||void 0===t?void 0:t.adProgramId,creativeTemplateName:null===(n=e.adCreativeMetaData)||void 0===n?void 0:n.adCreativeTemplateName,deviceType:e.deviceType,userAgent:navigator.userAgent}};let Fe=null,Re=null;new class{viewabilityStandards(){return Re=Re||[],Re}payload(){return Fe=Fe||{},Fe}};const Be="sfImpression",Oe="LightAdImpression",ze="viewablelatency",Ue=(e,t,n)=>({csaKey:e,csmKey:t,csmMessage:n}),He=(Ue("bodyBegin","bb",Be),Ue("bodyBegin","bb",Oe)),Ve=(Ue("bodyEnd","be"),Ue("clickToATF","af"),Ue("criticalFeature","cf"),Ue("criticalFeature","cf",Be),Ue("criticalFeature","cf",Oe),Ue("loaded","ld"));Ue("loaded","ld",Be),Ue("loaded","ld",Oe),Ue("viewablelatency:bodyBegin","bb",ze),Ue("viewablelatency:loaded","ld",ze);new RegExp(/((&#\d{2,4};)|(&[a-z]{2};)|(&[a-z]{3,7};)|(%[a-fA-F0-9]{2})|(\W))pd_rd_plhdr(=|%3D)t((&#\d{2,4};)|(&[a-z]{2,7};)|(%[a-fA-F0-9]{2})|(\W))/);const We=e=>e?e.toLowerCase().replace(/[^0-9a-z]/g,""):"unknown";var $e=function(e,t,n){Ge()&&(qe(Je(e,t.id,n)),qe(Je(e,p(t.name),n)))},Ge=function(){var e;return"function"==typeof(null===(e=null===window||void 0===window?void 0:window.ue)||void 0===e?void 0:e.tag)},qe=function(e){var t;return null===(t=null===window||void 0===window?void 0:window.ue)||void 0===t?void 0:t.tag(e)},Je=function(e,t,n){return"".concat(e,":").concat(t).concat(je(n))},je=function(e){return e?":".concat(e):""};const Ke=(e,t,n)=>{$e("adrender",e),$e("adrender:lightad",e),t.adCreativeId&&($e("adrender",e,`creativeid:${t.adCreativeId}`),y({creativeId:t.adCreativeId.toString()})),t.adProgramId&&($e("adrender",e,`programid:${t.adProgramId}`),y({programId:t.adProgramId.toString()})),void 0!==n&&y({isCardsFlow:n.toString()});const i=We(t.adCreativeTemplateName);$e("adrender",e,`creativetemplatename:${i}`),y({adrender:"true",creativeTemplateName:i,isLightAds:"true"})};function Qe(e,t,n){var i,a=n||{},r=a.noTrailing,s=void 0!==r&&r,o=a.noLeading,d=void 0!==o&&o,l=a.debounceMode,c=void 0===l?void 0:l,u=!1,m=0;function p(){i&&clearTimeout(i)}function h(){for(var n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];var o=this,l=Date.now()-m;function h(){m=Date.now(),t.apply(o,a)}function v(){i=void 0}u||(d||!c||i||h(),p(),void 0===c&&l>e?d?(m=Date.now(),s||(i=setTimeout(c?v:h,e))):h():!0!==s&&(i=setTimeout(c?v:h,void 0===c?e-l:e)))}return h.cancel=function(e){var t=(e||{}).upcomingOnly,n=void 0!==t&&t;p(),u=!n},h}const Ze=()=>window.innerHeight||document.documentElement.clientHeight,Ye=()=>window.innerWidth||document.documentElement.clientWidth,Xe=e=>e.getBoundingClientRect().top-Ze(),et=(e,t)=>({t:e.top,l:e.left,r:e.right,b:e.bottom,w:e.width,h:e.height,z:t}),tt=e=>{const t=e.getBoundingClientRect();return et(t,Number(window.getComputedStyle(e,null).zIndex))},nt=e=>{const t=function(e){const t=document.body.getBoundingClientRect();if(it(t))return null;const n=tt(e),i=Ze(),a=Ye(),r=Math.max(0,Math.min(t.left+a,n.r)-n.l),s=Math.max(0,Math.min(t.top+i,n.b)-n.t),o=r*s/(n.h*Math.min(n.w,a));return Number(Math.min(1,Math.max(0,o)).toFixed(2))}(e);return null==t?"unknown":t>=.5},it=e=>0===e.width&&0===e.height;const at=(e,t,n)=>{let i=!1;const a=()=>{const e=Xe(n);return e&&e<=t},r=()=>{a()&&(e(),i=!0)},s=Qe(20,(()=>{r(),i&&(window.removeEventListener("scroll",s),window.removeEventListener("resize",s))}));r(),i||(window.addEventListener("scroll",s),window.addEventListener("resize",s))},rt=({callback:e,errorCallback:t,delayConfig:n,placementDiv:i})=>{n=Pe(null!=n?n:"");const r=()=>{try{e()}catch(n){a("delayLoad failed",n),null==t||t()}};if(!n||"immediate"===n)return void r();const s=window.P,o=window.amznJQ;if("inView"===n){const e=new IntersectionObserver(((t,n)=>{(!(1===t.length&&void 0!==t[0].intersectionRatio.toFixed(2))||t[0].intersectionRatio>0)&&(r(),e.unobserve(i))}),{threshold:[0,.01]});e.observe(i)}else if(null==n?void 0:n.match("[^:]+:.+")){const e=n.split(":"),t=e[0].split("."),i=e[1],a=e.length>2?e[2]:i;s?s.when(a,"A").execute(r):o&&t.length>1?o[t[1]](i,r):r()}else(null==n?void 0:n.match(/^\d{1,4}px$/g))?at(r,parseInt(n,10),i):r()};var st={wb:"ues",bb:"uet",af:"uet",cf:"uet",be:"uet",ld:"uex"},ot=function(e){var t,n,i=e.latencyEvent,a=e.scope,r=e.placement,s=e.timestamp;dt(i)&&(lt(i,ct(a),r.id,s),lt(i,ct(a),p(r.name),s),lt(i,ct(a),null!==(t=u(r.name))&&void 0!==t?t:void 0,s),lt(i,ct(a),null!==(n=m(r.id))&&void 0!==n?n:void 0,s))},dt=function(e){return"function"==typeof window[st[e]]},lt=function(e,t,n,i){void 0===i&&(i=new Date);var a=st[e];n&&"function"==typeof window[a]&&window[a](e,t+n,{wb:1},i)},ct=function(e){return"adplacements:"+ut(e)},ut=function(e){return e?"".concat(e,":"):""},mt=function(e,t,n){if(window.csa)try{window.csa("Content",{element:e})("mark",t,null==n?void 0:n.getTime())}catch(i){a("Error with 'mark' CSA",i)}};class pt{sendLatencyMetric({latencyMetricType:e,placementId:t,placementName:n,placementDivId:i,timestamp:a}){ot({latencyEvent:e.csmKey,scope:e.csmMessage,placement:{id:t,name:n},timestamp:a}),mt(document.getElementById(i),e.csaKey,a)}}class ht{publishCount(){h(this.csmMetricName,this.placement),P(this.csaMetricName,this.placement),this.shouldFireSlotAgnosticMetric&&(v(this.csmMetricName),E(this.csaMetricName))}constructor(e,t,n,i=!1){this.csaMetricName=e,this.csmMetricName=t,this.placement=n,this.shouldFireSlotAgnosticMetric=i}}class vt{publishLatency(e){(new pt).sendLatencyMetric({latencyMetricType:this.latencyMetricType,placementId:this.placement.id,placementName:this.placement.name,placementDivId:this.placement.divId,timestamp:new Date(null!=e?e:performance.now())})}constructor(e,t){this.latencyMetricType=e,this.placement=t}}class wt{}wt.start=e=>new ht("adload_start","adload:start",e,!0),wt.renderError=e=>new ht("adload_rendererror","adload:rendererror",e),wt.callback=e=>new ht("adload_delayloadcallback","adload:delayloadcallback",e);const ft=e=>new vt(He,e),bt=e=>new vt(Ve,e),gt=(e,t)=>{const n=new Set(["bf4ab3db-618a-4853-ae89-3ad3bd17df16","dd4c5e61-fe9a-4d91-9deb-25fa60557719","da326e4a-90bd-4da3-a526-53301eb2c6a0","ca609359-3cb9-4984-8830-231c22e978d3","15554fd8-4c3e-45c6-ae61-84c65966f5d1","1396c5b8-45a1-4618-9a09-0b84209807f9","d9fb239d-fcde-414f-98a8-409c81052388","b60ea84b-3e24-44dc-9fdb-35bb2fb1fe5c","75b4c7aa-4c22-49d3-8371-15ca116eaf1f","ef368293-2611-4cef-8050-4fcd9b97f12e","db5cbac6-5194-4b52-9929-9ec0bbfed990","6479c6f3-a9c2-4d7c-9d1a-45008113fe0c"]);new Y(window,"A2I_HOMEPAGE_CARD_THEMING_360311").isT1()&&n.has(e)&&(t&&(t.style.background="linear-gradient(to right, #FFD07E, #EA7867)"),t&&(t.style.margin="0px"))},yt=e=>{if("V"===e.creative.mediaType)return;const t=e.creative;var n;v("resize:size:request"),t.size||(v("resize:size:missing"),_e(Ne("resize:size:missing",n,Me(e))))},Pt=e=>{for(const t of e)Et(t)},Et=e=>{At(e)||(xt(e),kt(e))},kt=async({placement:e,feedback:t,lightAdDetails:n})=>{try{var i;Ke(e,n.adCreativeMetaData,n.isCardsFlow),yt(n),wt.start(e).publishCount(),ft(e).publishLatency(),new Y(window,"ADPT_SF_SERVER_SIDE_SPONSORED_LABEL_998980").isT1()&&(null===(i=window.feedbackLabelFunctions)||void 0===i||i[e.parentDiv.id]());const a=t.addSponsoredLabel();if(gt(e.id,e.parentDiv),wt.callback(e).publishCount(),await e.render(),rt({callback:()=>e.track(),delayConfig:n.firePixelsAfter,placementDiv:e.div}),!(await a))return wt.renderError(e).publishCount(),void e.collapse()}catch(a){wt.renderError(e).publishCount(),e.collapse(),Tt(a)}},At=({placement:e})=>{var t;return!!(null===(t=fe().getByPlacement(e))||void 0===t?void 0:t.processedTimestamp)},xt=({placement:e,lightAdDetails:t})=>{var n;const i=null!==(n=fe().getByPlacement(e))&&void 0!==n?n:{};i.processedTimestamp=performance.now(),i.placement=e,i.lightAdDetails=t,fe().save(i)},Tt=e=>{a("Unable to process Light Ad",e)},It=e=>fe().getByPlacementDiv(e).lightAdDetails;class St{createFeedbackRequestDTO(){return{parentHtmlId:this.placement.parentDiv.id,placement:this.placement,feedback:{position:this.position,hidden:this.hidden,style:this.style,label:this.label,url:this.url}}}constructor(e,t,n,i,a,r){this.placement=e,this.position=t,this.hidden=n,this.style=i,this.label=a,this.url=r,this.addSponsoredLabel=async()=>{const e=this.createFeedbackRequestDTO();return me().addSponsoredLabel(e)}}}const Lt=(e,t)=>{return new St(e,t.adFeedbackInfo.adFeedbackOnTop?"TOP":"BOTTOM",!t.adFeedbackInfo.boolFeedback,t.adFeedbackInfo.feedbackDivStyle,{text:(n=t.adFeedbackInfo.sponsoredText,de(n)?se(n):n),style:t.adFeedbackInfo.fallbackTextStyle},{path:t.adFeedbackInfo.endPoint,parameters:{adPlacementMetaData:t.adPlacementMetaData,adCreativeMetaData:t.adCreativeMetaData}});var n},Ct=(e,t)=>{for(const n of Object.keys(t))e.style[n]=t[n];return e},Dt=(e,{widthThreshold:t,styleBelowThreshold:n,styleAboveThreshold:i})=>{if(!t||!n||!i)return;const a=e.offsetWidth<t?n:i;Ct(e,a)};class _t{get div(){return document.getElementById(this.divId)}get parentDiv(){return this.div.parentElement}constructor(e,t,n,i,a){this.id=e,this.name=t,this.divId=n,this.creative=i,this.resizeInfo=a,this.render=async()=>{var e,t;(t=this).resizeInfo.resizePlacement&&(window.addEventListener("resize",(()=>Dt(t.div,t.resizeInfo.resizePlacement))),Dt(t.div,t.resizeInfo.resizePlacement)),await this.creative.render(this),bt(this).publishLatency(null===(e=fe().getByPlacement(this))||void 0===e?void 0:e.adLoadTimestamp)},this.track=()=>{this.creative.track(this)},this.collapse=()=>{this.parentDiv.style.display="none"}}}const Nt=(e,t)=>({adElement:document.getElementById(e).querySelector("img"),async render(e){var n;Ft(e,t),this.adElement&&await(n=this.adElement,new Promise(((e,t)=>{n.addEventListener("load",(()=>e())),n.addEventListener("error",(e=>t(e))),n.complete&&e()})))},track(e){Mt(e,t),Rt(e,t)}}),Mt=(e,t)=>{var n,i;ee().isT1()?null===(n=t.btrPixel)||void 0===n||n.fire(e):t.impressionPixel.fire(e),t.measurabilityPixel.fire(e),null===(i=t.skanImpressionPixel)||void 0===i||i.fire()},Ft=(e,t)=>{ee().isT1()&&t.impressionPixel.fire(e)},Rt=(e,t)=>{var n;t.amznViewPixel.track(e),t.iabViewPixel.track(e),t.groupmViewPixel.track(e),null===(n=t.skanTrackingPixel)||void 0===n||n.track(e)};class Bt{async fire(e){this.isFired||(await fetch(this.pixelUrl(this.url,e),{keepalive:!0,mode:"no-cors"}),e.div.appendChild(this.pixel(e)),this.isFired=!0)}shouldFirePixel(e){return!0}constructor(e,t,n){this.url=e,this.isFired=!1,this.pixel=e=>{const t=document.createElement("img");return t.id=`${this.pixelId}_${e.name}`,t.style.display="none",t.setAttribute("pixel-url",this.pixelUrl(this.url,e)),t},this.shouldAppendABPTag=Ce({abpAcceptable:t,abpStatus:n})}}const Ot=e=>{const t=Le(document,e.div);return zt(e,t),(null==t?void 0:t.isBTRCompliant)?Ee:ke},zt=(e,t)=>{if(!t)return;const{isBTRTaggedCreative:n=!1,imagesData:i=[]}=t;n&&(h(Ut.TAGGED,e),v(Ut.TAGGED)),i.length?i.length&&i.every((e=>e.isLoaded))?(h(Ut.LOADED,e),v(Ut.LOADED)):(h(Ut.ERROR,e),v(Ut.ERROR)):(h(Ut.NO_IMAGES,e),v(Ut.NO_IMAGES))},Ut={LOADED:"btr:loaded",ERROR:"btr:error",IMPRESSION:"btr:impression",NO_IMAGES:"btr:noimages",TAGGED:"btr:taggedcreative"};class Ht extends Bt{constructor(e,t,n){super(e,t,n),this.pixelId="ape_impression",this.pixelUrl=(e,t)=>Ae(e,"pj",this.pixelUrlParameters(t)),this.pixelUrlParameters=e=>{const t=Ot(e);return{measurementMethod:t||void 0,ape_al:!!this.shouldAppendABPTag||void 0}}}}class Vt extends Bt{constructor(e,t,n){super(e,t,n),this.pixelId="ape_measurability",this.pixelUrl=(e,t)=>`${e.replace(/\/$/,"")}/atf/${JSON.stringify(this.pixelUrlParameters(t))}`,this.pixelUrlParameters=e=>({atf:nt(e.div),ape_al:!!this.shouldAppendABPTag||void 0})}}class Wt extends Bt{track(e){new IntersectionObserver(((t,n)=>{const i=()=>{this.fire(e),n.unobserve(e.div)};t.forEach((e=>{e.isIntersecting?this.thresholdTimeVisibleMs>0?this.intervalId=setTimeout((()=>i()),this.thresholdTimeVisibleMs):i():clearInterval(this.intervalId)}))}),{threshold:this.thresholdPercentage}).observe(e.div)}async fire(e){return this.shouldFirePixel(e)||await this.waitUntilShouldFirePixel(e),super.fire(e)}waitUntilShouldFirePixel(e){return new Promise((t=>{this.intervalId=setInterval((()=>{this.shouldFirePixel(e)&&(clearInterval(this.intervalId),t())}),10)}))}constructor(e,t,n,i,a){super(e,t,n),this.thresholdPercentage=i,this.thresholdTimeVisibleMs=a}}class $t extends Wt{get pixelId(){return`ape_viewability_${this.definition}`}constructor(e,t,n,i,a,r,s,o){super(e,t,n,i,a),this.definition=r,this.aPageStart=s,this.adStartTime=o,this.pixelUrl=(e,t)=>`${e.replace(/\/+$/,"")}/v/${JSON.stringify(this.pixelUrlParameters(t))}`,this.pixelUrlParameters=e=>({ape_al:!!this.shouldAppendABPTag||void 0,v:{def:this.definition,p:this.thresholdPercentage,t:this.thresholdTimeVisibleMs},wh:window.innerHeight||document.documentElement.clientHeight,ww:window.innerWidth||document.documentElement.clientWidth,sx:window.scrollX,sy:window.scrollY,ah:e.div.getBoundingClientRect().height,aw:e.div.getBoundingClientRect().width,top:e.div.getBoundingClientRect().top,left:e.div.getBoundingClientRect().left,ptv:(performance.now()-this.aPageStart)/1e3,ttv:(performance.now()-this.adStartTime)/1e3})}}class Gt extends $t{constructor(e,t,n,i,a){super(e,t,n,0,0,"amzn",i,a)}}class qt extends $t{constructor(e,t,n,i,a){super(e,t,n,1,1e3,"groupm",i,a)}}class Jt extends $t{constructor(e,t,n,i,a){super(e,t,n,.5,1e3,"iab",i,a)}}class jt extends $t{constructor(e,t,n,i,a){super(e,t,n,.3,1e3,"iab",i,a)}}class Kt extends $t{track(e){super.track(e);const t=e.creative.adElement;let n=0;t.addEventListener("play",(()=>{this.continuousPlaytime=0,n=performance.now()})),t.addEventListener("pause",(()=>this.continuousPlaytime=0)),t.addEventListener("ended",(()=>this.continuousPlaytime=0)),t.addEventListener("timeupdate",(()=>!t.paused&&(this.continuousPlaytime=performance.now()-n)))}shouldFirePixel(e){return super.shouldFirePixel(e)&&this.continuousPlaytime>=2e3}constructor(e,t,n,i,a){super(e,t,n,.5,2e3,"iab",i,a),this.continuousPlaytime=0}}const Qt="AppAdsMshopIOSPlugin";class Zt extends Ht{async fire(){var e,t;this.isFired||(e=this.skAdNetwork,null===(t=window.P)||void 0===t||t.when(Qt).execute((t=>{t.startAttributeViewThroughAppAds({skAdNetwork:e})})),this.isFired=!0)}constructor(e,t,n,i){super(e,t,n),this.skAdNetwork=i}}class Yt extends Wt{pixelUrl(){throw new Error("PixelUrl should not be use for SkanViewPixel")}async fire(){var e,t;this.isFired||(e=this.skAdNetwork,null===(t=window.P)||void 0===t||t.when(Qt).execute((t=>{t.endAttributeViewThroughAppAds({skAdNetwork:e})})),this.isFired=!0)}constructor(e,t,n,i){super(e,t,n,.5,2e3),this.skAdNetwork=i,this.pixelId="skan_view_pixel"}}class Xt extends Ht{async fire(e){if(this.shouldFirePixel(e))return super.fire(e)}shouldFirePixel(e){return Ot(e)===Ee}constructor(e,t,n){super(e,t,n),this.pixelId="ape_btr_impression",this.pixelUrl=(e,t)=>Ae(ue(e),"c",{measurementMethod:Ee})}}const en=e=>e.btrPixelUrl?new Xt(e.btrPixelUrl,e.abpAcceptable,e.abpStatus):void 0,tn=e=>new Vt(e.aaxInstrPixelUrl,e.abpAcceptable,e.abpStatus),nn=e=>new Gt(e.aaxInstrPixelUrl,e.abpAcceptable,e.abpStatus,e.aPageStart,e.adStartTime),an=(e,t,n)=>"V"===e?on(n):rn(t)?dn(n):ln(n),rn=e=>sn(e)>=242500,sn=e=>e.getBoundingClientRect().height*e.getBoundingClientRect().width,on=e=>new Kt(e.aaxInstrPixelUrl,e.abpAcceptable,e.abpStatus,e.aPageStart,e.adStartTime),dn=e=>new jt(e.aaxInstrPixelUrl,e.abpAcceptable,e.abpStatus,e.aPageStart,e.adStartTime),ln=e=>new Jt(e.aaxInstrPixelUrl,e.abpAcceptable,e.abpStatus,e.aPageStart,e.adStartTime),cn=e=>new qt(e.aaxInstrPixelUrl,e.abpAcceptable,e.abpStatus,e.aPageStart,e.adStartTime),un=e=>{if(e.skAdNetwork)return new Zt(e.aaxImpPixelUrl,e.abpAcceptable,e.abpStatus,e.skAdNetwork)},mn=e=>{if(e.skAdNetwork)return new Yt(e.aaxInstrPixelUrl,e.abpAcceptable,e.abpStatus,e.skAdNetwork)},pn="gw-desktop-herotator",hn=()=>{var e;null===(e=window.P)||void 0===e||e.when(pn).execute((e=>{e.pause()}))},vn=()=>{var e;null===(e=window.P)||void 0===e||e.when(pn).execute((e=>{e.resume()}))},wn=e=>{var t,n,i;t="page_changed",n=()=>e.currentTime=0,null===(i=window.P)||void 0===i||i.when(pn).execute((e=>{e.addObserver(t,n)})),e.paused||hn(),e.addEventListener("play",(()=>hn())),e.addEventListener("timeupdate",(()=>{e.paused||hn()})),e.addEventListener("pause",(()=>vn())),e.addEventListener("ended",(()=>vn()))},fn=/^((https?:)?\/\/)(.*\.)?amazon\./,bn="gw-video-orchestrator",gn=()=>{yn()},yn=e=>{var t;null===(t=window.P)||void 0===t||t.when(bn).execute((t=>{t.elect(e)}))},Pn=new Set,En=e=>{var t,n,a,r;t=e,n=t=>{t&&e.paused&&!Pn.has(e.id)?e.play():t||e.paused||e.pause()},a={priority:100},null===(r=window.P)||void 0===r||r.when(bn).execute((e=>{try{e.subscribe(t,n,a)}catch(r){r instanceof Error?i(`gw-video-orchestrator error: ${r.message}`):i(`gw-video-orchestrator error: ${r}`)}}))},kn=e=>{En(e),e.addEventListener("play",(()=>{yn(e)})),e.addEventListener("pause",(()=>gn())),e.addEventListener("ended",(()=>{Pn.add(e.id),gn()})),e.addEventListener("play",(()=>Pn.delete(e.id))),e.addEventListener("user-pause",(()=>Pn.add(e.id)))},An=new Set,xn=(e,t,n)=>({adElement:document.getElementById(e).querySelector("video"),async render(t){var n;this.adElement&&(Tn(this.adElement),In(this.adElement),wn(this.adElement),kn(this.adElement),Sn(e,this.adElement),await(n=this.adElement,new Promise(((e,t)=>{n.addEventListener("canplaythrough",(()=>e())),n.addEventListener("error",(e=>t(e))),n.readyState>=3&&e()}))))},track(e){const i=this.adElement;Ln(i,e,t,n),Cn(t,e),Dn(i,e,n)}}),Tn=e=>{e.readyState>=HTMLMediaElement.HAVE_ENOUGH_DATA?e.play():e.addEventListener("canplaythrough",(()=>{e.play()}),{once:!0})},In=e=>{e.addEventListener("ended",(()=>e.currentTime=0))},Sn=(e,t)=>{const n=e+"_h1_control_";var i;const a=null!==(i=document.getElementById(n+"play"))&&void 0!==i?i:document.getElementById(n+"replay"),r=document.getElementById(n+"pause"),s=document.getElementById(n+"muted"),o=document.getElementById(n+"audio");t.addEventListener("mute",(()=>{o.style.setProperty("display","none"),s.style.removeProperty("display")})),t.addEventListener("unmute",(()=>{s.style.setProperty("display","none"),o.style.removeProperty("display")})),t.addEventListener("pause",(()=>{r.style.setProperty("display","none"),a.style.removeProperty("display")})),t.addEventListener("ended",(()=>{r.style.setProperty("display","none"),a.style.removeProperty("display")})),t.addEventListener("play",(()=>{a.style.setProperty("display","none"),r.style.removeProperty("display")}))},Ln=(e,t,n,i)=>{if(e.paused)e.addEventListener("play",(()=>{var e;ee().isT1()?(null===(e=n.btrPixel)||void 0===e||e.fire(t),n.impressionPixel.fire(t)):n.impressionPixel.fire(t);n.measurabilityPixel.fire(t),Vn(i.impressions)}));else{var a;if(ee().isT1())null===(a=n.btrPixel)||void 0===a||a.fire(t),n.impressionPixel.fire(t);else n.impressionPixel.fire(t);n.measurabilityPixel.fire(t),Vn(i.impressions)}},Cn=(e,t)=>{e.amznViewPixel.track(t),e.iabViewPixel.track(t),e.groupmViewPixel.track(t)},Dn=(e,t,n)=>{_n(e,t,n),Nn(e,n),Mn(e,n),Fn(e,n),Rn(e,n),Bn(e,n),On(e,n),zn(e,n),Un(e,n),Hn(e,n)},_n=(e,t,n)=>{e.error?(t.collapse(),n.error&&Wn(n.error)):e.addEventListener("error",(()=>{t.collapse(),n.error&&Wn(n.error)}))},Nn=(e,t)=>{e.paused?e.addEventListener("play",(()=>Vn(t.start))):Vn(t.start)},Mn=(e,t)=>{e.addEventListener("timeupdate",(()=>{const n=e.currentTime/e.duration;n>=.25&&Vn(t.firstQuartile),n>=.5&&Vn(t.midpoint),n>=.75&&Vn(t.thirdQuartile)}))},Fn=(e,t)=>{e.addEventListener("ended",(()=>{Vn(t.complete)}))},Rn=(e,t)=>{e.addEventListener("mute",(()=>Vn(t.mute)))},Bn=(e,t)=>{e.addEventListener("unmute",(()=>Vn(t.unmute)))},On=(e,t)=>{e.addEventListener("pause",(()=>Vn(t.pause)))},zn=(e,t)=>{let n=-1;e.addEventListener("timeupdate",(()=>{e.currentTime<n&&Vn(t.rewind),n=e.currentTime}))},Un=(e,t)=>{let n=!1;e.addEventListener("pause",(()=>n=!0)),e.addEventListener("play",(()=>n&&Vn(t.resume)))},Hn=(e,t)=>{e.addEventListener("click",(e=>{var n;e.preventDefault(),Vn(t.clickTracking),t.clickThrough&&(n=t.clickThrough,fn.test(n)?setTimeout((()=>{window.open(n,"_top")}),150):window.open(n,"_blank"))}))},Vn=async e=>{for(const t of e)await Wn(t)},Wn=async e=>{An.has(e)||(await fetch(e,{keepalive:!0,mode:"no-cors",priority:"low"}),i("Fired pixel: "+e),An.add(e))},$n=e=>"V"===e.creative.mediaType?qn(e):Gn(e),Gn=e=>Nt(e.adUnitPlacementId,Jn(e)),qn=e=>{const t=e.creative;var n,i,a,r,s,o,d,l,c,u;return xn(e.adUnitPlacementId,Jn(e),{impressions:t.impressions,error:t.error,start:null!==(n=t.trackingEvents.start)&&void 0!==n?n:[],firstQuartile:null!==(i=t.trackingEvents.firstQuartile)&&void 0!==i?i:[],midpoint:null!==(a=t.trackingEvents.midpoint)&&void 0!==a?a:[],thirdQuartile:null!==(r=t.trackingEvents.thirdQuartile)&&void 0!==r?r:[],complete:null!==(s=t.trackingEvents.complete)&&void 0!==s?s:[],mute:null!==(o=t.trackingEvents.mute)&&void 0!==o?o:[],unmute:null!==(d=t.trackingEvents.unmute)&&void 0!==d?d:[],pause:null!==(l=t.trackingEvents.pause)&&void 0!==l?l:[],rewind:null!==(c=t.trackingEvents.rewind)&&void 0!==c?c:[],resume:null!==(u=t.trackingEvents.resume)&&void 0!==u?u:[],clickThrough:t.videoClicks.clickThrough,clickTracking:t.videoClicks.clickTracking})},Jn=e=>{var t,n;return{impressionPixel:(n=jn(e),new Ht(n.aaxImpPixelUrl,n.abpAcceptable,n.abpStatus)),measurabilityPixel:tn(jn(e)),amznViewPixel:nn(jn(e)),iabViewPixel:an(null!==(t=e.creative.mediaType)&&void 0!==t?t:"D",document.getElementById(e.adUnitPlacementId),jn(e)),groupmViewPixel:cn(jn(e)),skanImpressionPixel:un(jn(e)),skanTrackingPixel:mn(jn(e)),btrPixel:en(jn(e))}},jn=e=>{var t,n,i,a,r;return{aaxImpPixelUrl:e.aaxImpPixelUrl,aaxInstrPixelUrl:e.aaxInstrPixelUrl,aPageStart:null!==(i=null===(t=e.computed)||void 0===t?void 0:t.aPageStart)&&void 0!==i?i:0,adStartTime:null!==(a=null===(n=e.computed)||void 0===n?void 0:n.adStartTime)&&void 0!==a?a:0,abpAcceptable:e.abpAcceptable,abpStatus:null!==(r=e.abpStatus)&&void 0!==r?r:"-1",btrPixelUrl:e.btrPixelUrl,skAdNetwork:e.skAdNetwork}},Kn=e=>new _t(e.placementId,e.placementName,e.adUnitPlacementId,$n(e),Qn(e)),Qn=e=>({resizePlacement:e.resizePlacementStyle?{widthThreshold:parseInt(e.resizePlacementStyle.resizePlacementWidthThreshold,10),styleBelowThreshold:e.resizePlacementStyle.resizePlacementStyleBelowThreshold,styleAboveThreshold:e.resizePlacementStyle.resizePlacementStyleAboveThreshold}:{}}),Zn=e=>{const t=Kn(e);return{placement:t,feedback:Lt(t,e),lightAdDetails:e}};class Yn{replay(e){Xn(e).currentTime=0,this.play(e)}play(e){const t=Xn(e);t.play(),t.dispatchEvent(new CustomEvent("user-play"))}pause(e){const t=Xn(e);t.pause(),t.dispatchEvent(new CustomEvent("user-pause"))}mute(e){const t=Xn(e);t.muted=!0,t.dispatchEvent(new CustomEvent("mute"))}unmute(e){const t=Xn(e);t.muted=!1,t.dispatchEvent(new CustomEvent("unmute"))}visibilityChange(e,t){e.forEach((e=>{var t;null===(t=document.getElementById(e))||void 0===t||t.style.removeProperty("display")})),t.forEach((e=>{var t;null===(t=document.getElementById(e))||void 0===t||t.style.setProperty("display","none")}))}}const Xn=e=>{const t=document.getElementById(e);return fe().getByPlacementDiv(t).placement.creative.adElement};class ei{constructor(){this.processAds=()=>Pt(ti()),this.processAd=e=>Et(Zn(e)),this.feedback=new be,this.video=new Yn}}const ti=()=>[...document.getElementsByClassName("text/x-APE-lightAds")].map((e=>It(e))).map(Zn);window.APE_LA||(window.APE_LA=new ei),new Y(window,"ADPT_SF_LIGHTADS_REFACTOR_903064").isT1()||window.APE_LA.processAds()})();
//# sourceMappingURL=ApeDLA-1.50.497afce9.js.map
